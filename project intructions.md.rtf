{\rtf1\ansi\ansicpg1252\cocoartf2761
\cocoatextscaling0\cocoaplatform0{\fonttbl\f0\froman\fcharset0 Times-Roman;\f1\fmodern\fcharset0 Courier;\f2\froman\fcharset0 Times-Bold;
\f3\fmodern\fcharset0 Courier-Bold;}
{\colortbl;\red255\green255\blue255;\red0\green0\blue0;\red109\green109\blue109;}
{\*\expandedcolortbl;;\cssrgb\c0\c0\c0;\cssrgb\c50196\c50196\c50196;}
\margl1440\margr1440\vieww11520\viewh8400\viewkind0
\deftab720
\pard\pardeftab720\partightenfactor0

\f0\fs24 \cf0 \expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Markdown\
\
\pard\pardeftab720\partightenfactor0

\f1\fs26 \cf0 # \uc0\u55357 \u56517  Full Project Guide: AI Syllabus-to-Calendar Agent\
\
This document contains the end-to-end plan for building a Streamlit-based agentic workflow that parses PDFs and automates Google Calendar events.\
\
---\
\
## \uc0\u55357 \u57056 \u65039  Part 1: Architecture & Tech Stack\
- **UI:** Streamlit (Python-based web framework)\
- **PDF Parsing:** PyMuPDF (fitz)\
- **Agent Intelligence:** OpenAI GPT-4o-mini (JSON mode)\
- **Integration:** Google Calendar API (OAuth 2.0)\
- **Environment:** Python 3.10+\
\
---\
\
## \uc0\u55357 \u56592  Part 2: Google Cloud Console Setup (Extremely Detailed)\
You must perform these steps to give your code permission to edit your calendar.\
\
1. **Create Project:**\
   - Go to [Google Cloud Console](https://console.cloud.google.com/).\
   - Click "New Project" and name it `SyllabusAgent`.\
2. **Enable APIs:**\
   - Search for **"Google Calendar API"** and click **Enable**.\
3. **OAuth Consent Screen:**\
   - Go to **APIs & Services > OAuth consent screen**.\
   - User Type: **External**.\
   - App Name: `Syllabus Agent`.\
   - Developer Contact: Your email.\
   - **Scopes:** Add `https://www.googleapis.com/auth/calendar.events`.\
   - **Test Users:** Add your own `@gmail.com` address. **(Crucial: The app won't work without this during development).**\
4. **Create Credentials:**\
   - Go to **APIs & Services > Credentials**.\
   - Click **Create Credentials > OAuth client ID**.\
   - Application Type: **Desktop App**.\
   - Download the JSON file. **Rename it to `credentials.json`** and move it into your project folder.\
\
---\
\
## \uc0\u55357 \u56514  Part 3: Project Structure\
Create a folder named `syllabus-agent` and place these files inside:\
\
```text\
syllabus-agent/\
\uc0\u9500 \u9472 \u9472  app.py             # The full application code\
\uc0\u9500 \u9472 \u9472  credentials.json   # Downloaded from Google\
\uc0\u9500 \u9472 \u9472  .env               # Your API keys (do not share)\
\uc0\u9492 \u9472 \u9472  requirements.txt   # Library list\
\pard\pardeftab720\partightenfactor0

\f0\fs24 \cf3 \strokec3 \
\pard\pardeftab720\sa298\partightenfactor0

\f2\b\fs36 \cf0 \strokec2 \uc0\u55357 \u56507  Part 4: The Code\
\pard\pardeftab720\sa280\partightenfactor0

\fs28 \cf0 File: 
\f3\fs30\fsmilli15210 requirements.txt
\f2\fs28 \
\pard\pardeftab720\partightenfactor0

\f0\b0\fs24 \cf0 Plaintext\
\
\pard\pardeftab720\partightenfactor0

\f1\fs26 \cf0 streamlit\
openai\
google-auth-oauthlib\
google-api-python-client\
pymupdf\
python-dotenv\
\pard\pardeftab720\sa280\partightenfactor0

\f2\b\fs28 \cf0 File: 
\f3\fs30\fsmilli15210 app.py
\f2\fs28 \
\pard\pardeftab720\partightenfactor0

\f0\b0\fs24 \cf0 Python\
\
\pard\pardeftab720\partightenfactor0

\f1\fs26 \cf0 import streamlit as st\
import fitz  # PyMuPDF\
import json\
import os\
from openai import OpenAI\
from google_auth_oauthlib.flow import InstalledAppFlow\
from googleapiclient.discovery import build\
from dotenv import load_dotenv\
\
# Load OpenAI Key from .env file\
load_dotenv()\
client = OpenAI(api_key=os.getenv("OPENAI_API_KEY"))\
\
# 1. Google Calendar Authentication\
def get_calendar_service():\
    SCOPES = ['[https://www.googleapis.com/auth/calendar.events](https://www.googleapis.com/auth/calendar.events)']\
    flow = InstalledAppFlow.from_client_secrets_file('credentials.json', SCOPES)\
    creds = flow.run_local_server(port=0)\
    return build('calendar', 'v3', credentials=creds)\
\
# 2. Extract text from uploaded PDF\
def extract_text(pdf_file):\
    doc = fitz.open(stream=pdf_file.read(), filetype="pdf")\
    text = ""\
    for page in doc:\
        text += page.get_text()\
    return text\
\
# 3. AI Agent Logic\
def get_deadlines_from_ai(text):\
    prompt = f"""\
    You are an academic assistant. Extract all deadlines (assignments, exams, quizzes) from this syllabus text.\
    Return ONLY a JSON object with a key 'deadlines' containing a list of objects.\
    Each object must have:\
    - 'summary': The name of the assignment/exam.\
    - 'date': The date in YYYY-MM-DD format. (Assume the year is 2026 if not specified).\
    \
    Syllabus Text:\
    \{text[:6000]\} \
    """\
    \
    response = client.chat.completions.create(\
        model="gpt-4o-mini",\
        messages=[\{"role": "system", "content": "You are a helpful assistant that outputs JSON."\},\
                  \{"role": "user", "content": prompt\}],\
        response_format=\{"type": "json_object"\}\
    )\
    return json.loads(response.choices[0].message.content)['deadlines']\
\
# 4. Streamlit UI\
st.set_page_config(page_title="Syllabus Agent", page_icon="\uc0\u55357 \u56517 ")\
st.title("\uc0\u55357 \u56517  Syllabus to Calendar Agent")\
st.write("Upload your syllabus and I'll handle the scheduling.")\
\
uploaded_file = st.file_uploader("Upload Syllabus PDF", type="pdf")\
\
if uploaded_file:\
    if st.button("Extract & Sync to Google Calendar"):\
        with st.spinner("Agent is analyzing the syllabus..."):\
            # Step A: Get Text\
            raw_text = extract_text(uploaded_file)\
            \
            # Step B: AI Extraction\
            deadlines = get_deadlines_from_ai(raw_text)\
            \
            st.write("### Extracted Events:")\
            st.table(deadlines)\
            \
            # Step C: Google Calendar Sync\
            service = get_calendar_service()\
            for item in deadlines:\
                event = \{\
                    'summary': item['summary'],\
                    'start': \{'date': item['date']\},\
                    'end': \{'date': item['date']\},\
                \}\
                service.events().insert(calendarId='primary', body=event).execute()\
            \
            st.success(f"Successfully added \{len(deadlines)\} events to your calendar!")\
}